var g_resizecoeff = 0.5;main();function main(){	//Make certain that user interaction (display of dialogs, etc.) is turned on.	//app.scriptPreferences.userInteractionLevel = UserInteractionLevels.interactWithAll;	if (app.documents.length != 0){		//ダイアログ表示		if(myDisplayDialog() == true){				resizeXMLImage();		}	} else { 	   alert ("ドキュメントを開いてください");	}}function resizeXMLImage(){	var myDocument = app.activeDocument;	var images = myDocument.allGraphics;	for(var i=0; i<images.length; i++){		var img = images[i];				if(img.associatedXMLElement){			var xml = img.associatedXMLElement;			var zoom = xml.xmlAttributes.item('data-zoom');			var clip = xml.xmlAttributes.item('data-clip');			//ズーム			var zoomrate = 100*g_resizecoeff;			if(zoom!=null){				zoomrate = parseFloat(zoom.value)*g_resizecoeff;			}			img.horizontalScale = zoomrate;			img.verticalScale = zoomrate;			img.parent.fit(FitOptions.FRAME_TO_CONTENT);			//クリッピング			if(clip != null){				var param = clip.value.split('+');				var rect = img.parent;				var w = parseFloat(param[2])*zoomrate/100;				var h = parseFloat(param[3])*zoomrate/100;				rect.resize( BoundingBoxLimits.OUTER_STROKE_BOUNDS, 								AnchorPoint.TOP_LEFT_ANCHOR,								ResizeMethods.REPLACING_CURRENT_DIMENSIONS_WITH,								[w, h]				);				img.move("by", ['-' + param[0] + 'pt', '-' + param[1] + 'pt']);			}		}			}}function myDisplayDialog(){	//文字スタイルの一覧を取得	var myDocument = app.activeDocument;		//ダイアログ生成	var myDialog = app.dialogs.add({name:"図版リサイズとクリッピング"});	with(myDialog.dialogColumns.add()){		//説明ラベル		staticTexts.add({staticLabel:"リサイズ係数を入力してください"});		staticTexts.add({staticLabel:"係数が0.8なら画像倍率をzoom値*0.8とします"});		staticTexts.add({staticLabel:"画像のdpiが不統一だと結果も不統一になります"});		//パネルを追加		with(borderPanels.add()){			//ラベル			with(dialogColumns.add()){				staticTexts.add({staticLabel:"リサイズ係数"});			}			with(dialogColumns.add()){				var myInitialField = realEditboxes.add({editValue:g_resizecoeff});			}		}	}		myReturn = myDialog.show();	if (myReturn == true){		g_resizecoeff = myInitialField.editValue;		myDialog.destroy();		return true;	} else {		myDialog.destroy();		return false;	}		}